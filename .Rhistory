data$REFERRAL_SOURCE <- factor(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
#Replace all NA with "Unknown" in "TERMINATION_YEAR"
data[is.na(data$TERMINATION_YEAR),"TERMINATION_YEAR"]<-"Unknown"
data$TERMINATION_YEAR <- factor(data$TERMINATION_YEAR)
summary(data)
summary(data$TERMINATION_YEAR)
index<-sort(sample(nrow( data),round(.30*nrow(data ))))
training<- data[-index,]
test<- data[index,]
library(kknn)
predict_k1<-kknn(formula = TERMINATION_YEAR~.,training,test[,-1],k=1,kernel = "rectangular")
predict_k1<-kknn(formula = TERMINATION_YEAR~.,training,test[,-5],k=5,kernel = "rectangular")
predict_k1<-kknn(formula = TERMINATION_YEAR~.,training,test[,-30],k=30,kernel = "rectangular")
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
summary(data)
sum(is.na(data))  #Total 5394 NAs. All in 'TERMINATION_YEAR'
data$REFERRAL_SOURCE[data$REFERRAL_SOURCE == ""] <- "Unknown"
summary(data)
summary(data$REFERRAL_SOURCE)
# Remove "" level from "REFERRAL_SOURCE"
levels(data$REFERRAL_SOURCE)
data$REFERRAL_SOURCE <- factor(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
#Replace all NA with "Unknown" in "TERMINATION_YEAR"
data[is.na(data$TERMINATION_YEAR),"TERMINATION_YEAR"]<-"Unknown"
data$TERMINATION_YEAR <- factor(data$TERMINATION_YEAR)
summary(data)
summary(data$TERMINATION_YEAR)
index<-sort(sample(nrow( data),round(.30*nrow(data ))))
training<- data[-index,]
test<- data[index,]
library(kknn)
predict_k1<-kknn(formula = TERMINATION_YEAR~.,training[,c(-1)] , test[,c(-1)], k=1,k=1,kernel = "rectangular")
predict_k1<-kknn(formula = TERMINATION_YEAR~.,training[,c(-1)] , test[,c(-1)], k=1,kernel = "rectangular")
predict_k1<-kknn(formula = TERMINATION_YEAR~.,training[,c(-1)] , test[,c(-1)], k=1,kernel = "rectangular")
fit <- fitted(predict_k1)
table(test$TERMINATION_YEAR,fit)
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
summary(data)
sum(is.na(data))  #Total 5394 NAs. All in 'TERMINATION_YEAR'
hist(data$ANNUAL_RATE, main = "histogram for ANNUAL_RATE")
hist(data$HRLY_RATE, main = "histogram for HRLY_RATE")
data$JOBCODE <- as.factor(data$JOBCODE)
levels(data$JOBCODE)
summary(data$JOBCODE)
data$REFERRAL_SOURCE[data$REFERRAL_SOURCE == ""] <- "Unknown"
summary(data)
summary(data$REFERRAL_SOURCE)
# Histogram for "HRLY_RATE"
hist(data$HRLY_RATE, main = "histogram for HRLY_RATE")
levels(data$REFERRAL_SOURCE)
data$REFERRAL_SOURCE <- factor(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
idx <- sort(sample(nrow(data),as.integer(.7*nrow(data))))
training <- data[idx,]
test <- data[-idx,]
library(kknn)
predict_k3 <- kknn(formula = STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, training, test[,-21], k = 3,kernel ="rectangular")
summary(predict_k3)
STATUS_knn_k3 <- fitted(predict_k3)
summary(predict_k3)
STATUS_knn_k3 <- fitted(predict_k3)
table(STATUS = test$STATUS,STATUS_knn_k3 = STATUS_knn_k3)
test_knn_k3 <- cbind(test, STATUS_knn_k3 = STATUS_knn_k3)
View(test_knn_k3)
knn_k3_wrong <- sum(STATUS_knn_k3 != test$STATUS)
knn_k3_error_rate <- knn_k3_wrong/length(STATUS_knn_k3)
knn_k3_error_rate
View(data)
install.packages("C50")
library('C50')
C50_class <- C5.0( STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5,data=training )
library('C50')
C50_class <- C5.0( STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5,data=training )
View(data)
rm(list=ls())
filename<-file.choose()
dsn<-  read.csv(filename )
dev.off
filename<-file.choose()
dsn<-  read.csv(filename )
dev.off
View(dsn)
rm(list=ls())
filename<-file.choose()
dsn<-  read.csv(filename )
dev.off
View(dsn)
rm(list=ls())
filename<-file.choose()
dsn<-  read.csv(filename )
dev.off
View(dsn)
?na.omit()
dsn2<-na.omit(dsn)
set.seed(123)
?ifelse
View(dsn2)
index<-sort(sample(nrow(dsn),round(.25*nrow(dsn))))
training<-dsn[-index,]
test<-dsn[index,]
library('C50')
View(dsn)
C50_class <- C5.0( Survived~.,data=training )
View(C50_class)
summary(C50_class )
plot(C50_class)
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
summary(data)
sum(is.na(data))
data$JOBCODE <- as.factor(data$JOBCODE)
levels(data$JOBCODE)
summary(data$JOBCODE)
data$REFERRAL_SOURCE[data$REFERRAL_SOURCE == ""] <- "Unknown"
summary(data)
summary(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
data$REFERRAL_SOURCE <- factor(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
idx <- sort(sample(nrow(data),as.integer(.7*nrow(data))))
training <- data[idx,]
test <- data[-idx,]
library('C50')
C50_class <- C5.0( STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5,data=training )
C50_class <- C5.0( STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, data = training )
data$REHIRE <- as.factor(data$REHIRE)
levels(data$REHIRE)
summary(data$REHIRE)
C50_class <- C5.0( STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, data = training )
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
summary(data)
sum(is.na(data))  #Total 5394 NAs. All in 'TERMINATION_YEAR'
# Histogram for "ANNUAL_RATE"
hist(data$ANNUAL_RATE, main = "histogram for ANNUAL_RATE")
# Histogram for "HRLY_RATE"
hist(data$HRLY_RATE, main = "histogram for HRLY_RATE")
# Convert the data type of "JOBCODE" from "numeric" to "factor"
data$JOBCODE <- as.factor(data$JOBCODE)
levels(data$JOBCODE)
summary(data$JOBCODE)
# Replace all "" with "Unknown" in "REFERRAL_SOURCE"
data$REFERRAL_SOURCE[data$REFERRAL_SOURCE == ""] <- "Unknown"
summary(data)
summary(data$REFERRAL_SOURCE)
# Remove "" level from "REFERRAL_SOURCE"
levels(data$REFERRAL_SOURCE)
data$REFERRAL_SOURCE <- factor(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
# Convert the data type of "REHIRE" from "logical" to "factor"
data$REHIRE <- as.factor(data$REHIRE)
levels(data$REHIRE)
summary(data$REHIRE)
# Use 30% test 70% training data
idx <- sort(sample(nrow(data),as.integer(.7*nrow(data))))
training <- data[idx,]
test <- data[-idx,]
library('C50')
C50_class <- C5.0( STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, data = training )
summary(C50_class )
dev.off()
plot(C50_class)
summary(C50_class )
rm(list=ls())
filename<-file.choose()
dsn<-  read.csv(filename )
dev.off
?na.omit()
dsn2<-na.omit(dsn)
set.seed(123)
?ifelse
index<-sort(sample(nrow(dsn),round(.25*nrow(dsn))))
training<-dsn[-index,]
test<-dsn[index,]
library('C50')
library('C50')
C50_class <- C5.0( Survived~.,data=training )
summary(C50_class )
View(C50_class)
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
summary(data)
sum(is.na(data))  #Total 5394 NAs. All in 'TERMINATION_YEAR'
data$JOBCODE <- as.factor(data$JOBCODE)
levels(data$JOBCODE)
summary(data$JOBCODE)
data$REFERRAL_SOURCE[data$REFERRAL_SOURCE == ""] <- "Unknown"
summary(data)
summary(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
data$REFERRAL_SOURCE <- factor(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
data$REHIRE <- as.factor(data$REHIRE)
levels(data$REHIRE)
summary(data$REHIRE)
idx <- sort(sample(nrow(data),as.integer(.7*nrow(data))))
training <- data[idx,]
test <- data[-idx,]
library('C50')
C50_class <- C5.0( STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, data = training )
View(C50_class)
summary(C50_class )
C50_class <- C5.0( STATUS ~ ., data = training )
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
sum(is.na(data))  #Total 5394 NAs. All in 'TERMINATION_YEAR'
data$JOBCODE <- as.factor(data$JOBCODE)
levels(data$JOBCODE)
summary(data$JOBCODE)
# Replace all "" with "Unknown" in "REFERRAL_SOURCE"
data$REFERRAL_SOURCE[data$REFERRAL_SOURCE == ""] <- "Unknown"
summary(data)
summary(data$REFERRAL_SOURCE)
# Remove "" level from "REFERRAL_SOURCE"
levels(data$REFERRAL_SOURCE)
data$REFERRAL_SOURCE <- factor(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
# Convert the data type of "REHIRE" from "logical" to "factor"
data$REHIRE <- as.factor(data$REHIRE)
levels(data$REHIRE)
summary(data$REHIRE)
# Use 30% test 70% training data
idx <- sort(sample(nrow(data),as.integer(.7*nrow(data))))
training <- data[idx,]
test <- data[-idx,]
library('C50')
C50_class <- C5.0( STATUS ~ ., data = training )
summary(C50_class )
plot(C50_class)
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
summary(data)
sum(is.na(data))  #Total 5394 NAs. All in 'TERMINATION_YEAR'
hist(data$ANNUAL_RATE, main = "histogram for ANNUAL_RATE")
# Histogram for "HRLY_RATE"
hist(data$HRLY_RATE, main = "histogram for HRLY_RATE")
# Convert the data type of "JOBCODE" from "numeric" to "factor"
data$JOBCODE <- as.factor(data$JOBCODE)
levels(data$JOBCODE)
summary(data$JOBCODE)
# Replace all "" with "Unknown" in "REFERRAL_SOURCE"
data$REFERRAL_SOURCE[data$REFERRAL_SOURCE == ""] <- "Unknown"
summary(data)
summary(data$REFERRAL_SOURCE)
# Remove "" level from "REFERRAL_SOURCE"
levels(data$REFERRAL_SOURCE)
data$REFERRAL_SOURCE <- factor(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
# Convert the data type of "REHIRE" from "logical" to "factor"
data$REHIRE <- as.factor(data$REHIRE)
levels(data$REHIRE)
summary(data$REHIRE)
# Use 30% test 70% training data
idx <- sort(sample(nrow(data),as.integer(.7*nrow(data))))
training <- data[idx,]
test <- data[-idx,]
library(kknn)
predict_k3 <- kknn(formula = STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, training, test[,-21], k = 3,kernel ="rectangular")
summary(predict_k3)
STATUS_knn_k3 <- fitted(predict_k3)
# Confusion table
table(STATUS = test$STATUS,STATUS_knn_k3 = STATUS_knn_k3)
# Compare the prediction to actual test data
test_knn_k3 <- cbind(test, STATUS_knn_k3 = STATUS_knn_k3)
View(test_knn_k3)
# Error rate
knn_k3_wrong <- sum(STATUS_knn_k3 != test$STATUS)
knn_k3_error_rate <- knn_k3_wrong/length(STATUS_knn_k3)
knn_k3_error_rate
## k = 5
predict_k5 <- kknn(formula = STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, training, test[,-21], k = 5,kernel ="rectangular")
summary(predict_k5)
STATUS_knn_k5 <- fitted(predict_k5)
# Confusion table
table(STATUS = test$STATUS,STATUS_knn_k5 = STATUS_knn_k5)
# Compare the prediction to actual test data
test_knn_k5 <- cbind(test, STATUS_knn_k5 = STATUS_knn_k5)
View(test_knn_k5)
# Error rate
knn_k5_wrong <- sum(STATUS_knn_k5 != test$STATUS)
knn_k5_error_rate <- knn_k5_wrong/length(STATUS_knn_k5)
knn_k5_error_rate
## k = 10
predict_k10 <- kknn(formula = STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, training, test[,-21], k = 10,kernel ="rectangular")
summary(predict_k10)
STATUS_knn_k10 <- fitted(predict_k10)
library('C50')
C50_class <- C5.0( STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, data = training )
summary(C50_class )
plot(C50_class)
View(C50_class)
View(C50_class)
levelsC50_class)
levels(C50_class)
rm(list=ls())
filename<-file.choose()
dsn<-  read.csv(filename )
dev.off
dsn2<-na.omit(dsn)
index<-sort(sample(nrow(dsn),round(.25*nrow(dsn))))
training<-dsn[-index,]
test<-dsn[index,]
library('C50')
library('C50')
C50_class <- C5.0( Survived~.,data=training )
View(C50_class)
summary(C50_class )
plot(C50_class)
View(dsn)
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
summary(data)
sum(is.na(data))  #Total 5394 NAs. All in 'TERMINATION_YEAR'
data$JOBCODE <- as.factor(data$JOBCODE)
levels(data$JOBCODE)
summary(data$JOBCODE)
# Replace all "" with "Unknown" in "REFERRAL_SOURCE"
data$REFERRAL_SOURCE[data$REFERRAL_SOURCE == ""] <- "Unknown"
summary(data)
summary(data$REFERRAL_SOURCE)
# Remove "" level from "REFERRAL_SOURCE"
levels(data$REFERRAL_SOURCE)
data$REFERRAL_SOURCE <- factor(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
# Convert the data type of "REHIRE" from "logical" to "factor"
data$REHIRE <- as.factor(data$REHIRE)
levels(data$REHIRE)
summary(data$REHIRE)
# Use 30% test 70% training data
idx <- sort(sample(nrow(data),as.integer(.7*nrow(data))))
training <- data[idx,]
test <- data[-idx,]
library('C50')
C50_class <- C5.0( STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, data = training )
summary(data$ANNUAL_RATE)
summary(data$HRLY_RATE)
summary(data$JOBCODE)
summary(data$EMP_ID)
summary(data$ANNUAL_RATE)
summary(data$HRLY_RATE)
summary(data$JOBCODE)
summary(data$ETHNICITY)
levels(data$ETHNICITY)
summary(data$SEX)
summary(data$MARITAL_STATUS)
summary(data$JOB_SATISFACTION)
summary(data$AGE)
summary(data$NUMBER_OF_TEAM_CHANGED)
summary(data$REFERRAL_SOURCE)
summary(data$HIRE_MONTH)
summary(data$REHIRE)
summary(data$TERMINATION_YEAR)
summary(data$IS_FIRST_JOB)
summary(data$TRAVELLED_REQUIRED)
summary(data$PERFORMANCE_RATING)
summary(data$DISABLED_EMP)
summary(data$DISABLED_VET)
summary(data$EDUCATION_LEVEL)
summary(data$STATUS)
summary(data$JOB_GROUP)
summary(data$PREVYR_1)
summary(data$PREVYR_2)
summary(data$PREVYR_3)
summary(data$PREVYR_4)
summary(data$PREVYR_5)
data$ETHNICITY[data$ETHNICITY == ""] <- "Unknown"
summary(data$ETHNICITY)
levels(data$ETHNICITY)
data$ETHNICITY[data$ETHNICITY == " "] <- "Unknown"
data[which(data$ETHNICITY== ""),"ETHNICITY"]<-"Unknown"
summary(data$ETHNICITY)
levels(data$ETHNICITY)
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
summary(data)
sum(is.na(data))  #Total 5394 NAs. All in 'TERMINATION_YEAR'
ETHNICITY_random <- sample(c("AMIND", "ASIAN", "BLACK", "HISPA", "PACIF", "TWO", "WHITE"), size = 1)
ETHNICITY_random
levels(data$ETHNICITY)
data$ETHNICITY[data$ETHNICITY == " "] <- ETHNICITY_random
levels(data$ETHNICITY)
data$ETHNICITY <- factor(data$ETHNICITY)
levels(data$ETHNICITY)
ETHNICITY_random <- sample(c("AMIND", "ASIAN", "BLACK", "HISPA", "PACIF", "TWO", "WHITE"), size = 1)
ETHNICITY_random
levels(data$ETHNICITY)
data$ETHNICITY[data$ETHNICITY == " "] <- ETHNICITY_random
View(data)
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
summary(data)
sum(is.na(data))  #Total 5394 NAs. All in 'TERMINATION_YEAR'
ETHNICITY_random <- sample(c("AMIND", "ASIAN", "BLACK", "HISPA", "PACIF", "TWO", "WHITE"), size = 1)
ETHNICITY_random
levels(data$ETHNICITY)
data$ETHNICITY[data$ETHNICITY == " "] <- ETHNICITY_random
levels(data$ETHNICITY)
data$ETHNICITY <- factor(data$ETHNICITY)
levels(data$ETHNICITY)
summary(data$ETHNICITY)
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
ETHNICITY_random <- sample(c("AMIND", "ASIAN", "BLACK", "HISPA", "PACIF", "TWO", "WHITE"), size = 1)
ETHNICITY_random
levels(data$ETHNICITY)
data$ETHNICITY[data$ETHNICITY == " "] <- ETHNICITY_random
levels(data$ETHNICITY)
summary(data$ETHNICITY)
data$JOBCODE <- as.factor(data$JOBCODE)
levels(data$JOBCODE)
summary(data$JOBCODE)
ETHNICITY_random <- sample(c("AMIND", "ASIAN", "BLACK", "HISPA", "PACIF", "TWO", "WHITE"), size = 1)
ETHNICITY_random
levels(data$ETHNICITY)
data$ETHNICITY[data$ETHNICITY == " "] <- ETHNICITY_random
levels(data$ETHNICITY)
summary(data$ETHNICITY)
data$ETHNICITY <- factor(data$ETHNICITY)
levels(data$ETHNICITY)
data$REFERRAL_SOURCE[data$REFERRAL_SOURCE == ""] <- "Unknown"
summary(data)
summary(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
data$REFERRAL_SOURCE <- factor(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
data$REHIRE <- as.factor(data$REHIRE)
levels(data$REHIRE)
summary(data$REHIRE)
set.seed(123)
idx <- sort(sample(nrow(data),as.integer(.7*nrow(data))))
training <- data[idx,]
test <- data[-idx,]
C50 <- C5.0(STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, data=training)
library(C50)
C50 <- C5.0(STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, data=training)
summary(C50)
STATUS_C50 <- predict(C50, test , type="class" )
table(STATUS = test$STATUS,STATUS_C50 = STATUS_C50)
test_C50 <- cbind(test, STATUS_C50 = STATUS_C50)
View(test_C50)
install.packages("randomForest")
test_C50 <- cbind(test, STATUS_C50 = STATUS_C50)
C50_wrong <- sum(STATUS_C50 != test$STATUS)
C50_error_rate <- C50_wrong/length(STATUS_C50)
C50_error_rate
rm(list=ls())
file<-file.choose()
dsn<-read.csv(file)
View(dsn)
library(randomForest)
install.packages("randomForest")
install.packages("randomForest")
library(randomForest)
dsn2<-na.omit(dsn)
index<-sort(sample(nrow(dsn),round(.30*nrow(dsn2))))
training<-dsn[-index,]
test<-dsn[index,]
fit<-randomForest(Survived~.,data=training,importance=TRUE,ntree =1000)
importance(fit)
varImpPlot(fit)
Prediction<-predict(fit,test)
table(actual=test[,4],Prediction)
wrong<-(test[,4]!=Prediction)
error_rate<-sum(wrong)/length(wrong)
error_rate
rm(list=ls())
csvfile<-file.choose()
data<-  read.csv(csvfile)
data$JOBCODE <- as.factor(data$JOBCODE)
levels(data$JOBCODE)
summary(data$JOBCODE)
ETHNICITY_random <- sample(c("AMIND", "ASIAN", "BLACK", "HISPA", "PACIF", "TWO", "WHITE"), size = 1)
ETHNICITY_random
levels(data$ETHNICITY)
data$ETHNICITY[data$ETHNICITY == " "] <- ETHNICITY_random
levels(data$ETHNICITY)
summary(data$ETHNICITY)
data$ETHNICITY <- factor(data$ETHNICITY)
levels(data$ETHNICITY)
data$REFERRAL_SOURCE[data$REFERRAL_SOURCE == ""] <- "Unknown"
summary(data)
summary(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
data$REFERRAL_SOURCE <- factor(data$REFERRAL_SOURCE)
levels(data$REFERRAL_SOURCE)
data$REHIRE <- as.factor(data$REHIRE)
levels(data$REHIRE)
summary(data$REHIRE)
str(data)
set.seed(123)
idx <- sort(sample(nrow(data),as.integer(.7*nrow(data))))
training <- data[idx,]
test <- data[-idx,]
library(randomForest)
RF_fit <- randomForest(STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, data=training, importance=TRUE, ntree =1000)
RF_fit <- randomForest(STATUS ~ ., data=training, importance=TRUE, ntree =1000)
RF_fit <- randomForest(STATUS ~ ANNUAL_RATE + HRLY_RATE + JOBCODE + ETHNICITY + SEX + MARITAL_STATUS + JOB_SATISFACTION + AGE + NUMBER_OF_TEAM_CHANGED + REFERRAL_SOURCE + HIRE_MONTH + REHIRE + IS_FIRST_JOB + TRAVELLED_REQUIRED + PERFORMANCE_RATING + DISABLED_EMP + DISABLED_VET + EDUCATION_LEVEL + JOB_GROUP + PREVYR_1 + PREVYR_2 + PREVYR_3 + PREVYR_4 + PREVYR_5, data=training, importance=TRUE, ntree =3000)
